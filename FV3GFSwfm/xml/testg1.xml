<?xml version="1.0"?>
<!DOCTYPE workflow
[
  <!ENTITY FV3GFS_HOME "/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite">
  <!ENTITY PSLOT  "rt_ufscam_l64">
  <!ENTITY FCST_INTERVAL "6">            
  <!ENTITY ATCFNAME "ucs1">
  <!ENTITY FCST_LENGTH "168">

  <!-- External parameter entites -->
  <!ENTITY % SITES  SYSTEM "all_sites.xml">  %SITES;
  <!ENTITY % TASKS  SYSTEM "all_tasks.xml">  %TASKS;
  <!ENTITY % DEFS   SYSTEM "all_defs.xml">   %DEFS;

  %jet;

]>

  <workflow realtime="T" scheduler="&SCHEDULER;" cyclethrottle="10" cyclelifespan="0:25:00:00">
  <log><cyclestr>&FV3GFS_LOG;/workflow/workflow_@Y@m@d@H_hfipPlots.log</cyclestr></log> 

  <!-- set this to year month day(s) hour(s) minute - NOTE if you are running this for an earlier time,
       make sure you delete the .store file or it will not restart -->

  <cycledef>202007240000 202909030000 24:00:00</cycledef>
  <cycledef group="g1">0 0 23-31 7 2020 * </cycledef>

  <metatask name="g2hfipPlots">
    <var name="T"> 000 006 012 018 024 030 036 042 048 054 060 066 072 078 084 090 096 102 108 114 120 126 132 138 144 150 156 162 168</var>
    &hfipPlot_task;
  </metatask>  

  <metatask name="g1hfipPlots">
     <var name="T"> 000 006 012 018 024 030 036 042 048 054 060 066 072 078 084 090 096 102 108 114 120 126 132 138 144 150 156 162 168</var>
  
     <task name="hfip_G1plots_#T#" cycledefs="g1" maxtries="2"> 
       <command>&SCRIPTS;/hfipPlots_g1.ksh</command>
       <account>&PROJECT;</account>
       <cores>1</cores>
       &PARTITION_JET;
       <walltime>00:10:00</walltime>
       <jobname><cyclestr>hfipPlots_#T#_@H</cyclestr></jobname>
       <join><cyclestr>&FV3GFS_LOG;/hfipPlots/hfipPlots_#T#_@Y@m@d@H_g1.log</cyclestr></join>
       <envar><name>FV3GFS_HOME</name><value>&FV3GFS_HOME;</value></envar>
       <envar><name>HFIP_SCRIPT</name><value>&SCRIPTS;/hfipGlobalModelGraphics.ksh</value></envar> 
       <envar><name>TRACKFILE</name><value><cyclestr>&TRACKDIR;/tctrk.atcf.@Y@m@d@H.&ATCFNAME;.txt</cyclestr></value></envar> 
       <envar><name>FV3GFS_RUN</name><value><cyclestr>&FV3GFS_RUN;/&PSLOT;/&CDUMP;.@Y@m@d/@H/</cyclestr></value></envar>
       <envar><name>FCST_INTERVAL</name><value>&FCST_INTERVAL;</value></envar>
       <envar><name>ATCFNAME</name><value>&ATCFNAME;</value></envar>
       <envar><name>yyyymmddhhmm</name><value><cyclestr>@Y@m@d@H@M</cyclestr></value></envar>
       <envar><name>gribVersion</name><value>1</value></envar>
       <envar><name>gribName</name><value><cyclestr>&FV3GFS_RUN;/&PSLOT;/&CDUMP;.@Y@m@d/@H/&CDUMP;.t@Hz.pgrb2.0p25.f#T#</cyclestr></value></envar>
       <envar><name>T</name><value>#T#</value></envar>
       <dependency>
         <metataskdep metatask="g2hfipPlots"/>
       </dependency>
     </task>
  </metatask>  
   
   <!--
   -->
   
   </workflow>
