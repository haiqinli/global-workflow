<?xml version="1.0"?>
<!DOCTYPE workflow [
<!ENTITY FV3GFS_HOME "/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite">
<!ENTITY PSLOT "rt_ufscam_l64">
<!ENTITY FCST_INTERVAL "6">
<!ENTITY ATCFNAME "gcp1">
<!ENTITY FCST_LENGTH "168">
<!-- External parameter entites --><!ENTITY % SITES SYSTEM "all_sites.xml">
<!ENTITY % jet SYSTEM "jet.xml">
<!ENTITY % jet_retro SYSTEM "jet_retro.xml">
<!ENTITY % hera SYSTEM "hera.xml">
<!ENTITY % hera_retro SYSTEM "hera_retro.xml">
<!ENTITY % TASKS SYSTEM "all_tasks.xml">
<!ENTITY nclzip_task SYSTEM "FV3GFS_NCLzip.xml">
<!ENTITY remapgrib_task SYSTEM "FV3GFS_RemapGrib.xml">
<!ENTITY ncl_task SYSTEM "FV3GFS_NCL.xml">
<!ENTITY nclfim_task SYSTEM "FV3GFS_NCLFim.xml">
<!ENTITY ac_verif_task SYSTEM "Global_Verif.xml">
<!ENTITY ac_verif_file_task SYSTEM "GFSVerifFileRealTime.xml">
<!ENTITY ac_verif_back_task SYSTEM "GFSVerifFileBackfill.xml">
<!ENTITY hfipPlot_task SYSTEM "FV3GFS_HfipPlots.xml">
<!ENTITY hfipPlotG1_task SYSTEM "FV3GFS_HfipPlotsG1.xml">
<!ENTITY % DEFS SYSTEM "all_defs.xml">
<!ENTITY % dbi SYSTEM "dbi.xml">
<!ENTITY % metatasks SYSTEM "metatask_defs.xml">
<!--  <!ENTITY DATADIR "/lfs4/HFIP/gsd-fv3-hfip/fv3-ccpp"> --><!-- jet.xml --><!ENTITY SCHEDULER "slurm">
<!ENTITY PROJECT "gsd-fv3-dev">
<!ENTITY PE "batch">
<!ENTITY SERVICE "service">
<!ENTITY MET_MODULE "/contrib/met/modulefiles">
<!ENTITY MET_VERSION "met/8.0">
<!ENTITY FV3GFS_LOG "&FV3GFS_HOME;/FV3GFSwfm/log">
<!ENTITY FV3GFS_RUN "&FV3GFS_HOME;/FV3GFSrun">
<!ENTITY FV3GFS_WFM "&FV3GFS_HOME;/FV3GFSwfm">
<!ENTITY FV3GFS_POST_DIR "post/fim">
<!ENTITY SCRIPTS "&FV3GFS_HOME;/FV3GFSwfm/scripts">
<!ENTITY RTFIM_HOME "/home/rtfim">
<!ENTITY LFS4_ROOT "/lfs4/HFIP/gsd-fv3-hfip">
<!ENTITY CLIMATE_DIR "&LFS4_ROOT;/cmean/">
<!ENTITY PUB_DIR "/public">
<!ENTITY TRACKDIR "&FV3GFS_HOME;/tracks/">
<!ENTITY NCL_HOME "&LFS4_ROOT;/rtruns/ncl/fimall">
<!ENTITY NCL_DIFF_HOME "&LFS4_ROOT;/rtruns/ncl/fimalldiff">
<!ENTITY CNVGRIB "cnvgrib">
<!ENTITY WGRIB "wgrib">
<!ENTITY WGRIB2 "wgrib2">
<!ENTITY GFS_VERIF_DIR "&PUB_DIR;/data/grids/gfs/0p5deg/grib2">
<!ENTITY GFS_VERIF_RETRO_DIR "&LFS4_ROOT;/GFS_RETRO_VERIF_FILES">
<!ENTITY FV3GFS_VERIF_DIR "&FV3GFS_RUN;">
<!ENTITY CDUMP "gfs">
<!ENTITY CASE "C768">
<!ENTITY PARTITION_JET "<partition>sjet,vjet,ujet,tjet,kjet,xjet</partition>">
]>
<workflow realtime="F" scheduler="slurm" cyclethrottle="8">
  <log><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSwfm/log/workflow/workflow_@Y@m@d@H_hfipPlots_retro.log</cyclestr></log> 

  <!-- set this to year month day(s) hour(s) minute - NOTE if you are running this for an earlier time,
       make sure you delete the .store file or it will not restart -->

  <cycledef>202007290000 202007290000 24:00:00</cycledef>
  <cycledef group="g1">0 0 23-31 * 2020-2021 * </cycledef>

  <metatask name="g2hfipPlots">
    <var name="T"> 000 006 012 018 024 030 036 042 048 054 060 066 072 078 084 090 096 102 108 114 120 126 132 138 144 150 156 162 168</var>
      <task name="hfip_plots_#T#" maxtries="2">
    <command>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSwfm/scripts/hfipPlots.ksh</command>
    <account>gsd-fv3-dev</account>
    <cores>2</cores>
    <partition>sjet,vjet,ujet,tjet,kjet,xjet</partition>
    <walltime>00:10:00</walltime>
    <jobname><cyclestr>hfipPlots_#T#_@H</cyclestr></jobname>
    <join><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSwfm/log/hfipPlots/hfipPlots_#T#_@Y@m@d@H.log</cyclestr></join>
    <envar><name>HFIP_SCRIPT</name><value>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSwfm/scripts/hfipGlobalModelGraphics.ksh</value></envar> 
    <envar><name>TRACKFILE</name><value><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/tracks//tctrk.atcf.@Y@m@d@H.gcp1.txt</cyclestr></value></envar> 
    <envar><name>FV3GFS_RUN</name><value><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSrun/rt_ufscam_l64/gfs.@Y@m@d/@H/</cyclestr></value></envar>
    <envar><name>FCST_INTERVAL</name><value>6</value></envar>
    <envar><name>ATCFNAME</name><value>gcp1</value></envar>
    <envar><name>g2file</name><value><cyclestr>gfs.t@Hz.pgrb2.0p25.f#T#</cyclestr></value></envar>
    <envar><name>yyyymmddhhmm</name><value><cyclestr>@Y@m@d@H@M</cyclestr></value></envar>
    <envar><name>T</name><value>#T#</value></envar>
    <dependency>
      <or>
        <and>
          <datadep age="120"><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSrun/rt_ufscam_l64/gfs.@Y@m@d/@H/gfs.t@Hz.pgrb2.0p25.f#T#</cyclestr></datadep>
          <datadep minsize="1b"><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/tracks//tctrk.atcf.@Y@m@d@H.gcp1.txt</cyclestr></datadep>
        </and>
        <and>
          <datadep age="120"><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSrun/rt_ufscam_l64/gfs.@Y@m@d/@H/gfs.t@Hz.pgrb2.0p25.f#T#</cyclestr></datadep>
          <timedep><cyclestr offset="013:30:00">@Y@m@d@H@M00</cyclestr></timedep>
        </and>
      </or>
    </dependency>
  </task>

  </metatask>  
  <metatask name="g1hfipPlots">
    <var name="T"> 000 006 012 018 024 030 036 042 048 054 060 066 072 078 084 090 096 102 108 114 120 126 132 138 144 150 156 162 168</var>
      <task name="hfip_G1plots_#T#" cycledefs="g1" maxtries="2">
    <command>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSwfm/scripts/hfipPlots_g1.ksh</command>
    <account>gsd-fv3-dev</account>
    <cores>1</cores>
    <partition>sjet,vjet,ujet,tjet,kjet,xjet</partition>
    <walltime>00:10:00</walltime>
    <jobname><cyclestr>hfipPlots_#T#_@H</cyclestr></jobname>
    <join><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSwfm/log/hfipPlots/hfipPlots_#T#_@Y@m@d@H_g1.log</cyclestr></join>
    <envar><name>FV3GFS_HOME</name><value>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite</value></envar>
    <envar><name>HFIP_SCRIPT</name><value>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSwfm/scripts/hfipGlobalModelGraphics.ksh</value></envar> 
    <envar><name>TRACKFILE</name><value><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/tracks//tctrk.atcf.@Y@m@d@H.gcp1.txt</cyclestr></value></envar> 
    <envar><name>FV3GFS_RUN</name><value><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSrun/rt_ufscam_l64/gfs.@Y@m@d/@H/</cyclestr></value></envar>
    <envar><name>FCST_INTERVAL</name><value>6</value></envar>
    <envar><name>ATCFNAME</name><value>gcp1</value></envar>
    <envar><name>yyyymmddhhmm</name><value><cyclestr>@Y@m@d@H@M</cyclestr></value></envar>
    <envar><name>gribVersion</name><value>1</value></envar>
    <envar><name>gribName</name><value><cyclestr>/lfs4/HFIP/gsd-fv3-hfip/rtruns/UFS-CAMsuite/FV3GFSrun/rt_ufscam_l64/gfs.@Y@m@d/@H/gfs.t@Hz.pgrb2.0p25.f#T#</cyclestr></value></envar>
    <envar><name>T</name><value>#T#</value></envar>
    <dependency>
      <metataskdep metatask="g2hfipPlots"/>
    </dependency>
  </task>


  </metatask>  


</workflow>
